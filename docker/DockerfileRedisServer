FROM greenbone/redis-server

# Switch to root to create directory and set permissions
USER root

# Create the /data directory and set permissions
RUN mkdir -p /data && chmod -R 777 /data

# Copy the Redis configuration file
COPY /redis/redis.conf /usr/local/etc/redis/redis.conf

# Expose the Redis port
EXPOSE 6379

# Revert to non-root user if necessary (optional, depends on base image)
# USER redis

# Start Redis with the custom configuration
CMD ["redis-server", "/usr/local/etc/redis/redis.conf"]
